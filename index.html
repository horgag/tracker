<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Serve Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gray-900 text-white p-6 flex flex-col items-center">
  <h1 class="text-2xl font-bold mb-4">Serve Tracker</h1>
  
  <div class="flex gap-2 mb-6">
    <button onclick="prevSet()" class="px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-xl">←</button>
    <span id="setLabel" class="px-6 py-2 bg-gray-800 rounded-lg text-xl font-semibold">Set 1</span>
    <button onclick="nextSet()" class="px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-xl">→</button>
  </div>
  
  <div class="w-full max-w-sm space-y-4">
    <button onclick="add('first')" class="w-full py-8 text-2xl font-semibold bg-green-600 hover:bg-green-500 active:bg-green-700 rounded-2xl">
      1st Serve <span id="first" class="text-3xl ml-2">0</span>
    </button>

    <button onclick="add('second')" class="w-full py-8 text-2xl font-semibold bg-yellow-600 hover:bg-yellow-500 active:bg-yellow-700 rounded-2xl">
      2nd Serve <span id="second" class="text-3xl ml-2">0</span>
    </button>

    <button onclick="add('double')" class="w-full py-8 text-2xl font-semibold bg-red-600 hover:bg-red-500 active:bg-red-700 rounded-2xl">
      Double Fault <span id="double" class="text-3xl ml-2">0</span>
    </button>
  </div>

  <div class="mt-6 flex items-center gap-3 bg-red-900/50 px-5 py-3 rounded-xl">
    <svg class="w-8 h-8 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="10" stroke-width="2"/>
      <line x1="8" y1="8" x2="16" y2="16" stroke-width="2"/>
      <line x1="16" y1="8" x2="8" y2="16" stroke-width="2"/>
    </svg>
    <span class="text-lg text-red-300">Double Faults:</span>
    <span id="dfTotal" class="text-2xl font-bold text-red-400">0</span>
  </div>

  <p id="setStats" class="mt-4 text-lg text-gray-400">Set: 0 serves | 0%</p>
  <p id="totalStats" class="mt-2 text-lg text-white">Total: 0 serves | 0%</p>

  <div class="flex gap-4 mt-6">
    <button onclick="resetSet()" class="px-6 py-3 text-lg bg-gray-700 hover:bg-gray-600 rounded-xl">Reset Set</button>
    <button onclick="resetAll()" class="px-6 py-3 text-lg bg-red-800 hover:bg-red-700 rounded-xl">Reset All</button>
  </div>

  <script>
    let currentSet = parseInt(localStorage.getItem('serve_currentSet')) || 0;
    
    function getSet(i) {
      return JSON.parse(localStorage.getItem(`serve_set_${i}`)) || {first:0, second:0, double:0};
    }
    
    function saveSet(i, data) {
      localStorage.setItem(`serve_set_${i}`, JSON.stringify(data));
    }
    
    function saveCurrentSet() {
      localStorage.setItem('serve_currentSet', currentSet);
    }
    
    function getAllSets() {
      let sets = [];
      for (let i = 0; i <= currentSet; i++) {
        sets.push(getSet(i));
      }
      return sets;
    }
    
    function render() {
      let s = getSet(currentSet);
      ['first','second','double'].forEach(t => document.getElementById(t).textContent = s[t]);
      
      let setTotal = s.first + s.second + s.double;
      let setPct = setTotal > 0 ? Math.round(s.first / setTotal * 100) : 0;
      document.getElementById('setLabel').textContent = `Set ${currentSet + 1}`;
      document.getElementById('setStats').textContent = `Set ${currentSet + 1}: ${setTotal} serves | ${setPct}%`;
      
      let t = {first:0, second:0, double:0};
      getAllSets().forEach(x => { t.first += x.first; t.second += x.second; t.double += x.double; });
      let total = t.first + t.second + t.double;
      let totalPct = total > 0 ? Math.round(t.first / total * 100) : 0;
      document.getElementById('totalStats').textContent = `Total: ${total} serves | ${totalPct}%`;
      document.getElementById('dfTotal').textContent = t.double;
    }
    
    function add(t) {
      let s = getSet(currentSet);
      s[t]++;
      saveSet(currentSet, s);
      render();
    }
    
    function prevSet() {
      if (currentSet > 0) { currentSet--; saveCurrentSet(); render(); }
    }
    
    function nextSet() {
      currentSet++;
      saveCurrentSet();
      render();
    }
    
    function resetSet() {
      saveSet(currentSet, {first:0, second:0, double:0});
      render();
    }
    
    function resetAll() {
      for (let i = 0; i <= currentSet; i++) {
        localStorage.removeItem(`serve_set_${i}`);
      }
      currentSet = 0;
      saveCurrentSet();
      render();
    }
    
    render();
  </script>
</body>
</html>
